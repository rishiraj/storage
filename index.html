<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Random Background Color</title>
    <style>
        body {
            transition: background-color 1s ease-in-out, color 1s ease-in-out;
            background-color: #000;
            color: #fff;
        }
    </style>
</head>
<body>
    <p>Some text on the page</p>
    <script>
        function changeColor() {
            // Generate a random color code
            var colorCode = "#" + Math.floor(Math.random()*16777215).toString(16);
            // Calculate the inverse color
            var r = 255 - parseInt(colorCode.substring(1,3),16);
            var g = 255 - parseInt(colorCode.substring(3,5),16);
            var b = 255 - parseInt(colorCode.substring(5,7),16);
            var inverseColor = "rgb(" + r + "," + g + "," + b + ")";
            // Calculate the contrast ratio
            var contrastRatio = getContrastRatio(colorCode, inverseColor);
            // If the contrast ratio is less than 4.5:1, generate a new color
            if (contrastRatio < 4.5) {
                changeColor();
            } else {
                // Apply the new color as the background color
                document.body.style.backgroundColor = colorCode;
                // Apply the inverse color as the text color
                document.body.style.color = inverseColor;
                // Wait 1 second and call the function again
                setTimeout(changeColor, 2000);
            }
        }

        function getContrastRatio(color1, color2) {
            var lum1 = getRelativeLuminance(color1);
            var lum2 = getRelativeLuminance(color2);
            if (lum1 > lum2) {
                return (lum1 + 0.05) / (lum2 + 0.05);
            } else {
                return (lum2 + 0.05) / (lum1 + 0.05);
            }
        }

        function getRelativeLuminance(color) {
            var r = parseInt(color.substring(1,3), 16) / 255;
            var g = parseInt(color.substring(3,5), 16) / 255;
            var b = parseInt(color.substring(5,7), 16) / 255;
            if (r <= 0.03928) {
                r = r / 12.92;
            } else {
                r = Math.pow(((r + 0.055) / 1.055), 2.4);
            }
            if (g <= 0.03928) {
                g = g / 12.92;
            } else {
                g = Math.pow(((g + 0.055) / 1.055), 2.4);
            }
            if (b <= 0.03928) {
                b = b / 12.92;
            } else {
                b = Math.pow(((b + 0.055) / 1.055), 2.4);
            }
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        }

        // Call the changeColor function to start the animation
        changeColor();
    </script>
</body>
</html>
